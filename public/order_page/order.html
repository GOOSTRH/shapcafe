<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart / SHAPCafeOnline</title>
    <link rel="stylesheet" type="text/css" href="order.css">
</head>
<body>
    <section class="header">
        <a class='back btn' href="../home_page/home.html">&#8249;</a>
    </section>

    <section class="main">
        <div class="container">
            <h1 class="logo">Shopping Cart</h2>
            <hr>
            <table id="cart-table">
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Quantity</th>
                        <th>Total</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="cart-items">
                    <!-- Cart items will be dynamically generated here -->
                </tbody>
            </table>
        </div>
    </section>





    <script>
        // Render cart items
        function renderCart() {
            const cartItemsContainer = document.getElementById('cart-items');
            cartItemsContainer.innerHTML = '';

            let cart = getCookie('cart') ? JSON.parse(getCookie('cart')) : [];
            let totalPrice = 0;

            cart.forEach((item, index) => {
                const total = item.price * item.quantity;
                totalPrice += total;

                const row = `
                    <tr>
                        <td><p class="name">${item.name}</p></td>
                        <td><input class="quan" type="number" value="${item.quantity}" min="1" onchange="updateQuantity(${index}, this.value)"></td>
                        <td><p class="ttl">₱${total}</p></td>
                        <td><a class="rmv" onclick="removeFromCart(${index})">X</a></td>
                    </tr>
                `;
                cartItemsContainer.innerHTML += row;
            });

            // Display total price
            const totalRow = `
                <tr>
                    <td colspan="3">Total:</td>
                    <td>₱${totalPrice}</td>
                    <td></td>
                </tr>
            `;
            cartItemsContainer.innerHTML += totalRow;
        }

        // Function to get a cookie
        function getCookie(name) {
            const decodedCookie = decodeURIComponent(document.cookie);
            const cookies = decodedCookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                let cookie = cookies[i];
                while (cookie.charAt(0) === ' ') {
                    cookie = cookie.substring(1);
                }
                if (cookie.indexOf(name) === 0) {
                    return cookie.substring(name.length + 1, cookie.length);
                }
            }
            return "";
        }

        // Remove item from cart
        function removeFromCart(index) {
            let cart = getCookie('cart') ? JSON.parse(getCookie('cart')) : [];
            cart.splice(index, 1);
            document.cookie = `cart=${JSON.stringify(cart)}; expires=${new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toUTCString()}; path=/`;
            renderCart();
        }

        // Update quantity of an item in the cart
        function updateQuantity(index, newQuantity) {
            let cart = getCookie('cart') ? JSON.parse(getCookie('cart')) : [];
            cart[index].quantity = parseInt(newQuantity);
            document.cookie = `cart=${JSON.stringify(cart)}; expires=${new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toUTCString()}; path=/`;
            renderCart();
        }

        // Render the initial cart items when the page loads
        renderCart();
    </script>

</body>
</html>
